# CMS-добавка для статического сайта «Нежный онлайн»

Эта добавка даёт простую админку (одна страница) для редактирования JSON‑файлов в репозитории (`/data/news.json`, `/data/speakers.json`, `/data/rubrics.json`, `/data/festivals.json`). 
Сохранение выполняется через **Google Apps Script → GitHub API**: без VPS, БД и PHP.

## Быстрый запуск (10–20 минут)

1) **Скопируйте файлы** из архива в корень вашего сайта:
   - `admin.html` (новая страница админки),
   - `js/admin-cms.js`,
   - Проверьте `js/config.js` и добавьте поля `CMS_ENDPOINT` и `ADMIN_KEY` (см. `js/config.sample.js`).

2) **Настройте Apps Script** (сервер):
   - Создайте новый проект Apps Script → вставьте `apps_script/Code.gs`,
   - В *Project Settings → Script Properties* добавьте:
     - `ADMIN_KEY` — сильный секрет (должен совпадать с `window.ADMIN_KEY` для UX, но хранится на сервере),
     - `GITHUB_TOKEN` — токен GitHub с правами на коммиты (repo),
     - `GH_REPO` — `owner/repo` (например `belchic05/nezhniy_online`),
     - `GH_BRANCH` — ветка, например `main` или `gh-pages`,
   - `Deploy → New deployment → Web app → Who has access: Anyone`,
   - Скопируйте URL и вставьте в `window.CMS_ENDPOINT` в `js/config.js`.

3) **Откройте `/admin.html`** на GitHub Pages, войдите по админ‑ключу и отредактируйте нужный JSON. Через ~10–60 секунд изменения будут на сайте.

## Где хранятся данные?

В тех же JSON‑файлах в вашем репозитории (`/data/*.json`). Это полностью совместимо с текущими страницами `news.html`, `speakers.html`, `rubrics.html`, `festivals.html` которые уже читают эти файлы.

## Безопасность

- Настоящая проверка ключа и секретов выполняется на стороне Apps Script. В браузере — лишь удобная проверка.
- В `Code.gs` задайте только ваш origin в массиве `ORIGIN_ALLOWLIST`.
- GitHub токен хранится только в Script Properties (сервере). В фронтенде — нет секретов.

## Как добавить дополнительные сущности?

Добавьте новую вкладку в `TABS` (в `js/admin-cms.js`) и укажите путь до JSON‑файла + стандартную схему. 
Файл будет редактироваться точно так же.

---

## Альтернативы и что выбрать

- **PHP + MySQL (или SQLite) на хостинге** — классический способ (WordPress / Laravel / OctoberCMS). Даёт мощную админку и роли пользователей, но нужен бэкенд‑хостинг и обновления/безопасность. Хорошо, если у вас уже есть LAMP‑хостинг и нужна редакция статей с медиа/ролями.
- **Headless CMS (Strapi, Directus, Payload) + ваш фронт** — гибко, красиво, REST/GraphQL. Нужен сервер (VPS/Render/Railway) и минимум DevOps. Лучший выбор для активной редакции многими авторами и сложных связей.
- **Git‑based CMS (Decap CMS/TinaCMS)** — редактирование прямо в репозитории через UI, без БД. Идеально для GitHub Pages/статических сайтов, лёгкая поддержка, версии/ревью через PR. Требует настроить авторизацию (Netlify Identity или GitHub OAuth). 
- **Google Sheets / Airtable как база** — просто стартовать, особенно если уже пользуетесь таблицами. Можно проксировать через Apps Script (как в текущем решении) и кэшировать на фронте.

**Рекомендация для этого проекта:** так как сайт размещён на GitHub Pages и данные уже лежат в JSON — оптимально использовать представленный вариант **Apps Script → GitHub (без сервера/БД)** или Git‑based CMS. Он сохранит статический хостинг, позволит быстро править контент, а все изменения версионируются в Git.

